# ModSecurity Rules for Category: SQL
SecRuleEngine On

SecRule REQUEST_URI "\(\?i\)\(\?:Sybase\ message:\|Warning\.\{2,20\}sybase\|Sybase\.\*Server\ message\.\*\)" "id:9000197,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 4" "id:9000202,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i\)Dynamic\ SQL\ Error" "id:9000186,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i\)P\(\?:ostgreSQL\(\?:\ query\ failed:\|\.\{1,20\}ERROR\)\|G::\[a\-z\]\*Error\)\|\(\?:pg_\(\?:query\|exec\)\\\(\\\)\ \\\[\|org\\\.postgresql\\\.util\\\.PSQLException\):\|Warning\.\{1,20\}\\bpg_\.\*\|valid\ PostgreSQL\ result\|Npgsql\\\.\|Supplied\ argument\ is\ not\ a\ valid\ PostgreSQL\ \.\*\?\ resource\|\(\?:Unable\ to\ connect\ to\ PostgreSQL\ serv\|invalid\ input\ syntax\ for\ integ\)er" "id:9000195,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i:Warning\.\*ingres_\|Ingres\ SQLSTATE\|Ingres\\W\.\*Driver\)" "id:9000190,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i\)org\\\.hsqldb\\\.jdbc" "id:9000188,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 4" "id:9000203,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 1" "id:9000179,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i:\\\[DM_QUERY_E_SYNTAX\\\]\|has\ occurred\ in\ the\ vicinity\ of:\)" "id:9000185,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i:An\ illegal\ character\ has\ been\ found\ in\ the\ statement\|com\\\.informix\\\.jdbc\|Exception\.\*Informix\)" "id:9000189,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 3" "id:9000201,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i:DB2\ SQL\ error:\|\\\[IBM\\\]\\\[CLI\ Driver\\\]\\\[DB2/6000\\\]\|CLI\ Driver\.\*DB2\|DB2\ SQL\ error\|db2_\\w\+\\\(\)" "id:9000184,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@pm\ gzip\ compress\ deflate\ br\ zstd" "id:9000178,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 2" "id:9000199,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i\)Exception\ \(\?:condition\ \)\?\\d\+\\\.\ Transaction\ rollback\\\." "id:9000187,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i\)\(\?:Warning\.\*sqlite_\.\*\|Warning\.\*SQLite3::\|SQLite/JDBCDriver\|SQLite\\\.Exception\|System\\\.Data\\\.SQLite\\\.SQLiteException\)" "id:9000196,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 2" "id:9000198,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i\)\(\?:supplied\ argument\ is\ not\ a\ valid\ \|SQL\ syntax\.\*\)MySQL\|Column\ count\ doesn't\ match\(\?:\ value\ count\ at\ row\)\?\|mysql_fetch_array\\\(\\\)\|on\ MySQL\ result\ index\|You\ have\ an\ error\ in\ your\ SQL\ syntax\(\?:;\|\ near\)\|MyS\(\?:QL\ server\ version\ for\ the\ right\ syntax\ to\ use\|qlClient\\\.\)\|\\\[MySQL\\\]\\\[ODBC\|\(\?:Table\ '\[\^'\]\+'\ doesn't\ exis\|valid\ MySQL\ resul\)t\|Warning\.\{1,10\}mysql_\(\?:\[\\\(\\\)_a\-z\]\{1,26\}\)\?\|\(\?:ERROR\ \[0\-9\]\{4\}\ \\\(\[0\-9a\-z\]\{5\}\\\)\|XPATH\ syntax\ error\):" "id:9000194,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 1" "id:9000180,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i\)\(\?:System\\\.Data\\\.OleDb\\\.OleDbException\|\\\[Microsoft\\\]\\\[ODBC\ SQL\ Server\ Driver\\\]\|\\\[Macromedia\\\]\\\[SQLServer\ JDBC\ Driver\\\]\|\\\[SqlException\|System\\\.Data\\\.SqlClient\\\.SqlException\|Unclosed\ quotation\ mark\ after\ the\ character\ string\|'80040e14'\|mssql_query\\\(\\\)\|Microsoft\ OLE\ DB\ Provider\ for\ ODBC\ Drivers\|Microsoft\ OLE\ DB\ Provider\ for\ SQL\ Server\|Incorrect\ syntax\ near\|Sintaxis\ incorrecta\ cerca\ de\|Syntax\ error\ in\ string\ in\ query\ expression\|Procedure\ or\ function\ \.\*\ expects\ parameter\|Unclosed\ quotation\ mark\ before\ the\ character\ string\|Syntax\ error\ \.\*\ in\ query\ expression\|Data\ type\ mismatch\ in\ criteria\ expression\\\.\|ADODB\\\.Field\ \\\(0x800A0BCD\\\)\|the\ used\ select\ statements\ have\ different\ number\ of\ columns\|OLE\ DB\.\*SQL\ Server\|Warning\.\*mssql_\.\*\|Driver\.\*SQL\[\ _\-\]\*Server\|SQL\ Server\.\*Driver\|SQL\ Server\.\*\[0\-9a\-fA\-F\]\{8\}\|Exception\.\*\\WSystem\\\.Data\\\.SqlClient\\\.\|Conversion\ failed\ when\ converting\ the\ varchar\ value\ \.\*\?\ to\ data\ type\ int\\\.\)" "id:9000193,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i:<b>Warning</b>:\ ibase_\|Unexpected\ end\ of\ command\ in\ statement\)" "id:9000191,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 3" "id:9000200,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i:SQL\ error\.\*POS\[0\-9\]\+\.\*\|Warning\.\*maxdb\.\*\)" "id:9000192,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i:JET\ Database\ Engine\|Access\ Database\ Engine\|\\\[Microsoft\\\]\\\[ODBC\ Microsoft\ Access\ Driver\\\]\)" "id:9000182,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i\)\\bORA\-\[0\-9\]\[0\-9\]\[0\-9\]\[0\-9\]\[0\-9\]:\|java\\\.sql\\\.SQLException\|Oracle\(\?:\ erro\|\[\^\\\(\\\)\]\{0,20\}Drive\)r\|Warning\.\{1,10\}o\(\?:ci_\.\{1,30\}\|ra_\.\{1,20\}\)" "id:9000183,phase:2,t:none,deny,status:403,log,msg:'SQL attack detected',severity:MEDIUM"
