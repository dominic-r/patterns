# ModSecurity Rules for Category: JAVA
SecRuleEngine On

SecRule REQUEST_URI "@pm\ gzip\ compress\ deflate\ br\ zstd" "id:9000000,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 2" "id:9000006,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 1" "id:9000002,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 4" "id:9000010,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 2" "id:9000608,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 3" "id:9000615,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule ARGS "\\xac\\xed\\x00\\x05" "id:9000610,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 1" "id:9000597,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule ARGS "\(\?:clonetransformer\|forclosure\|instantiatefactory\|instantiatetransformer\|invokertransformer\|prototypeclonefactory\|prototypeserializationfactory\|whileclosure\|getproperty\|filewriter\|xmldecoder\)" "id:9000612,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule ARGS "\(\?:clonetransformer\|forclosure\|instantiatefactory\|instantiatetransformer\|invokertransformer\|prototypeclonefactory\|prototypeserializationfactory\|whileclosure\|getproperty\|filewriter\|xmldecoder\)" "id:9000602,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 2" "id:9000607,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\.\*\\\.\(\?:jsp\|jspx\)\\\.\*\$" "id:9000605,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 2" "id:9000005,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 1" "id:9000598,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule ARGS "\(\?:runtime\|processbuilder\)" "id:9000600,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule ARGS "\(\?:cnVudGltZQ\|HJ1bnRpbWU\|BydW50aW1l\|cHJvY2Vzc2J1aWxkZXI\|HByb2Nlc3NidWlsZGVy\|Bwcm9jZXNzYnVpbGRlcg\|Y2xvbmV0cmFuc2Zvcm1lcg\|GNsb25ldHJhbnNmb3JtZXI\|BjbG9uZXRyYW5zZm9ybWVy\|Zm9yY2xvc3VyZQ\|GZvcmNsb3N1cmU\|Bmb3JjbG9zdXJl\|aW5zdGFudGlhdGVmYWN0b3J5\|Gluc3RhbnRpYXRlZmFjdG9yeQ\|BpbnN0YW50aWF0ZWZhY3Rvcnk\|aW5zdGFudGlhdGV0cmFuc2Zvcm1lcg\|Gluc3RhbnRpYXRldHJhbnNmb3JtZXI\|BpbnN0YW50aWF0ZXRyYW5zZm9ybWVy\|aW52b2tlcnRyYW5zZm9ybWVy\|Gludm9rZXJ0cmFuc2Zvcm1lcg\|BpbnZva2VydHJhbnNmb3JtZXI\|cHJvdG90eXBlY2xvbmVmYWN0b3J5\|HByb3RvdHlwZWNsb25lZmFjdG9yeQ\|Bwcm90b3R5cGVjbG9uZWZhY3Rvcnk\|cHJvdG90eXBlc2VyaWFsaXphdGlvbmZhY3Rvcnk\|HByb3RvdHlwZXNlcmlhbGl6YXRpb25mYWN0b3J5\|Bwcm90b3R5cGVzZXJpYWxpemF0aW9uZmFjdG9yeQ\|d2hpbGVjbG9zdXJl\|HdoaWxlY2xvc3VyZQ\|B3aGlsZWNsb3N1cmU\)" "id:9000617,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule ARGS "java\\b\.\+\(\?:runtime\|processbuilder\)" "id:9000613,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?:runtime\|processbuilder\)" "id:9000603,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule ARGS "\(\?:rO0ABQ\|KztAAU\|Cs7QAF\)" "id:9000611,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule ARGS "\(\?i\)\(\?:\\\$\|\&dollar;\?\)\(\?:\\\{\|\&l\(\?:brace\|cub\);\?\)" "id:9000620,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 1" "id:9000001,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "\(\?i\)\(\?:unmarshaller\|base64data\|java\\\.\)" "id:9000601,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 4" "id:9000009,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule ARGS "\(\?i\)\(\?:\\\$\|\&dollar;\?\)\(\?:\\\{\|\&l\(\?:brace\|cub\);\?\)\(\?:\[\^\\\}\]\*\(\?:\\\$\|\&dollar;\?\)\(\?:\\\{\|\&l\(\?:brace\|cub\);\?\)\|jndi\|ctx\)" "id:9000609,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule ARGS "java\\\.lang\\\.\(\?:runtime\|processbuilder\)" "id:9000599,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 4" "id:9000619,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 3" "id:9000616,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 4" "id:9000618,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule ARGS "\(\?:class\\\.module\\\.classLoader\\\.resources\\\.context\\\.parent\\\.pipeline\|springframework\\\.context\\\.support\\\.FileSystemXmlApplicationContext\)" "id:9000614,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 3" "id:9000007,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule ARGS "\(\?i\)\(\?:\\\$\|\&dollar;\?\)\(\?:\\\{\|\&l\(\?:brace\|cub\);\?\)\(\?:\[\^\\\}\]\{0,15\}\(\?:\\\$\|\&dollar;\?\)\(\?:\\\{\|\&l\(\?:brace\|cub\);\?\)\|jndi\|ctx\)" "id:9000606,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
SecRule REQUEST_URI "@lt\ 3" "id:9000008,phase:2,t:none,deny,status:403,log,msg:'JAVA attack detected',severity:MEDIUM"
